[gd_scene load_steps=38 format=3 uid="uid://bjd5mc6am3ew2"]


[ext_resource type="PackedScene" uid="uid://dmmmdnc8ncew3" path="res://Levels/enemy_spawn_point.tscn" id="1_hniko"]
[ext_resource type="Script" path="res://create_polygon_collision.gd" id="1_jfiiu"]
[ext_resource type="Script" path="res://DeckSystem/scripts/draw_machine.gd" id="2_64nos"]
[ext_resource type="PackedScene" uid="uid://cn7kpytcc8vb6" path="res://Tank/tank_body.tscn" id="2_ratli"]
[ext_resource type="Resource" uid="uid://k3kkpsyl26go" path="res://DeckSystem/res/draw_machine_params.tres" id="3_ecclo"]
[ext_resource type="Script" path="res://Targeting/core/scripts/range_band_man.gd" id="4_0x5lf"]
[ext_resource type="PackedScene" uid="uid://d0n1mrhpljpa7" path="res://PlayerWeapon/gun.tscn" id="4_7yh0l"]
[ext_resource type="Script" path="res://DeckSystem/scripts/card_pile.gd" id="4_q3nlh"]
[ext_resource type="Script" path="res://DeckSystem/scripts/initializer.gd" id="5_8preq"]
[ext_resource type="Script" path="res://Targeting/core/scripts/targeting_system.gd" id="5_q0d5c"]
[ext_resource type="Script" path="res://DeckSystem/scripts/conveyor_input.gd" id="6_0nco4"]
[ext_resource type="Resource" uid="uid://os5juiyfbgh0" path="res://Targeting/core/res/test_targeting_system_params.tres" id="6_2h460"]
[ext_resource type="PackedScene" uid="uid://dxepdy5igvcaj" path="res://Cards/card_artillery_targeting.tscn" id="6_6f2vl"]
[ext_resource type="Script" path="res://Targeting/core/res/direct_fire.gd" id="7_3kj6s"]
[ext_resource type="Resource" uid="uid://q66wqv5ap4h3" path="res://DeckSystem/res/input_params.tres" id="7_lwbna"]
[ext_resource type="Script" path="res://DeckSystem/scripts/conveyor_engine_pressure.gd" id="8_om5io"]
[ext_resource type="Resource" path="res://cannon_swivel.tres" id="8_rynsc"]
[ext_resource type="Resource" uid="uid://bot4oo3bc224u" path="res://DeckSystem/res/conveyor_engine_pressure_params.tres" id="9_22oty"]
[ext_resource type="Script" path="res://DeckSystem/scripts/conveyor_cursor.gd" id="10_da7bb"]
[ext_resource type="Resource" uid="uid://jl8xycbq1i3v" path="res://DeckSystem/res/cursor_params.tres" id="11_b38iv"]
[ext_resource type="Script" path="res://DeckSystem/scripts/conveyor_belt.gd" id="12_cfnii"]
[ext_resource type="Texture2D" uid="uid://nv6loj7feksp" path="res://shade.png" id="12_t1rsn"]
[ext_resource type="Resource" uid="uid://hl3ytboesg3u" path="res://DeckSystem/res/conveyor_res.tres" id="13_4qym4"]
[ext_resource type="Shape2D" uid="uid://ddwm33113h1iw" path="res://DeckSystem/res/conveyor_shape.tres" id="14_ab8fw"]
[ext_resource type="Script" path="res://DeckSystem/scripts/jettison_trigger.gd" id="15_ssd4j"]
[ext_resource type="Script" path="res://DeckSystem/scripts/discard_trigger.gd" id="16_euwjv"]
[ext_resource type="Script" path="res://PlayerResources/engine_pressure_script.gd" id="17_ck7oh"]
[ext_resource type="Script" path="res://RefRelay/node_reference_relay_res_gates.gd" id="18_i5i46"]
[ext_resource type="Resource" uid="uid://dq8p2jvcwjecm" path="res://PlayerResources/res/engine_pressure_params.tres" id="18_i714n"]
[ext_resource type="Resource" uid="uid://bmvmblmbjcb6v" path="res://RefRelay/discard_relay.tres" id="19_4vnf4"]
[ext_resource type="Script" path="res://PlayerResources/grease_script.gd" id="19_axreu"]
[ext_resource type="Resource" uid="uid://drx1xa7c7sg03" path="res://PlayerResources/res/grease_params.tres" id="20_u8qqm"]
[ext_resource type="Script" path="res://Camera/camera_swivel.gd" id="29_jvnny"]
[ext_resource type="Resource" uid="uid://dl8at50jg6f2n" path="res://Camera/camera_res.tres" id="30_8vekv"]
[ext_resource type="Script" path="res://Camera/camera_follow.gd" id="31_hlrvo"]
[ext_resource type="PackedScene" uid="uid://cltvcq41a4h8o" path="res://SFX/audio_manager.tscn" id="34_ji0kl"]
[ext_resource type="PackedScene" uid="uid://cy8ppkr8jxswc" path="res://SoundTracks/MusicPlayer.tscn" id="35_y2nll"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_tinjm"]
size = Vector2(382.486, 165.439)

[sub_resource type="WorldBoundaryShape2D" id="WorldBoundaryShape2D_171kb"]

[node name="main" type="Node2D"]

[node name="enemySpawnPoint" parent="." instance=ExtResource("1_hniko")]
position = Vector2(1596, 57)

[node name="Ground" type="Node2D" parent="."]
position = Vector2(-676, 364)

[node name="Polygon2D" type="Polygon2D" parent="Ground"]
position = Vector2(47, -2358)
color = Color(0.41, 0.205, 0, 1)
polygon = PackedVector2Array(647, 2479, 844, 2502, 1082, 2513, 1280, 2519, 1466, 2517, 1625, 2502, 1834, 2464, 1975, 2417, 2089, 2400, 2241, 2400, 2451, 2378, 2575, 2349, 2702, 2346, 2786, 2366, 2903, 2419, 3015, 2457, 3154, 2484, 3297, 2506, 3521, 2517, 3829, 2521, 3990, 2517, 4230, 2504, 4344, 2490, 4425, 2487, 4441, 2492, 4451, 2499, 4459, 2517, 4469, 2596, 4478, 2643, 4493, 2669, 4517, 2674, 4544, 2670, 4572, 2658, 4635, 2620, 4707, 2561, 4744, 2520, 4764, 2511, 4792, 2507, 4816, 2507, 5110, 2493, 5404, 2471, 5518, 2460, 5609, 2463, 5898, 2450, 6173, 2425, 6281, 2426, 6506, 2440, 6823, 2461, 6958, 2470, 6982, 2475, 7026, 2479, 7062, 2472, 7119, 2451, 7926, 2188, 7986, 2165, 8018, 2135, 8058, 2087, 8098, 2053, 8130, 2042, 8170, 2034, 8207, 2021, 8244, 2003, 8277, 1987, 8334, 1968, 8395, 1955, 8491, 1932, 8531, 1928, 8585, 1928, 8661, 1932, 8773, 1943, 8866, 1958, 8982, 1980, 9109, 2017, 9208, 2057, 9286, 2079, 9441, 2114, 9745, 2178, 10055, 2232, 10296, 2267, 10404, 2275, 10549, 2257, 10707, 2244, 11380, 2219, 11927, 2200, 12542, 2207, 16312, 2240, 18445, 2189, 20832, 2189, 25353, 2088, 25606, 10014, -11207, 11137, -1712, 3135, -1418, 2808, -1299, 2641, -1132, 2470, -1018, 2399, -943, 2386, -856, 2403, -580, 2470, -342, 2498, -214, 2517, -73, 2502, 95, 2487, 168, 2485, 178, 2487, 188, 2491, 196, 2497, 200, 2506, 203, 2524, 225, 2578, 236, 2605, 253, 2615, 277, 2617, 313, 2616, 349, 2607, 354, 2595, 354, 2562, 347, 2514, 341, 2496, 341, 2479, 356, 2472, 374, 2471, 400, 2475, 484, 2471)
script = ExtResource("1_jfiiu")

[node name="StaticBody2D" type="StaticBody2D" parent="Ground/Polygon2D"]

[node name="Area2D" type="Area2D" parent="Ground/Polygon2D"]
monitoring = false

[node name="TankBody" parent="." instance=ExtResource("2_ratli")]
position = Vector2(-879, 302)
gravity_scale = 0.01

[node name="Cannon" type="Node2D" parent="TankBody"]
position = Vector2(171, -86)

[node name="RangeBandMan" type="Node2D" parent="TankBody/Cannon" node_paths=PackedStringArray("discard_pile", "targeting_system")]
script = ExtResource("4_0x5lf")
discard_pile = NodePath("../../../ScreenBody/DeckSystem/DiscardPile")
targeting_system = NodePath("../Targeting")

[node name="Targeting" type="Area2D" parent="TankBody/Cannon"]
collision_layer = 0
collision_mask = 256
monitorable = false
script = ExtResource("5_q0d5c")
params = ExtResource("6_2h460")

[node name="Swivel" type="Node2D" parent="TankBody/Cannon" node_paths=PackedStringArray("targeting")]
rotation = -0.654498
script = ExtResource("7_3kj6s")
params = ExtResource("8_rynsc")
targeting = NodePath("../Targeting")

[node name="Gun" parent="TankBody/Cannon/Swivel" instance=ExtResource("4_7yh0l")]

[node name="CameraStick" type="Node2D" parent="TankBody"]
position = Vector2(1421, 0)

[node name="CameraSwivel" type="Node2D" parent="." node_paths=PackedStringArray("tank", "camera_stick")]
position = Vector2(627, 506)
script = ExtResource("29_jvnny")
params = ExtResource("30_8vekv")
tank = NodePath("../TankBody")
camera_stick = NodePath("../TankBody/CameraStick")

[node name="ColorRect" type="ColorRect" parent="CameraSwivel"]
offset_right = 40.0
offset_bottom = 40.0
color = Color(0, 1, 0.0666666, 1)

[node name="ScreenBody" type="RigidBody2D" parent="." node_paths=PackedStringArray("swivel")]
position = Vector2(610, 477)
collision_layer = 0
collision_mask = 0
gravity_scale = 0.0
can_sleep = false
lock_rotation = true
linear_damp = 1.0
script = ExtResource("31_hlrvo")
params = ExtResource("30_8vekv")
swivel = NodePath("../CameraSwivel")

[node name="Camera2D" type="Camera2D" parent="ScreenBody"]
zoom = Vector2(0.3, 0.3)

[node name="Shade" type="Sprite2D" parent="ScreenBody"]
modulate = Color(1, 1, 1, 0.862745)
position = Vector2(0, 988)
scale = Vector2(2.1, 2.1)
texture = ExtResource("12_t1rsn")

[node name="DeckSystem" type="Node2D" parent="ScreenBody"]
position = Vector2(-1561, 555)

[node name="DrawMachine" type="Node2D" parent="ScreenBody/DeckSystem" node_paths=PackedStringArray("draw_pile", "discard_pile")]
position = Vector2(3800, 200)
script = ExtResource("2_64nos")
params = ExtResource("3_ecclo")
draw_pile = NodePath("../DrawPile")
discard_pile = NodePath("../DiscardPile")

[node name="DrawPile" type="Node" parent="ScreenBody/DeckSystem"]
script = ExtResource("4_q3nlh")

[node name="Initializer" type="Node" parent="ScreenBody/DeckSystem/DrawPile"]
script = ExtResource("5_8preq")

[node name="ArtilleryTargetingCard" parent="ScreenBody/DeckSystem/DrawPile/Initializer" instance=ExtResource("6_6f2vl")]
position = Vector2(0, 0)

[node name="DiscardPile" type="Node" parent="ScreenBody/DeckSystem"]
script = ExtResource("4_q3nlh")

[node name="DiscardPileRefGates" type="Node" parent="ScreenBody/DeckSystem" node_paths=PackedStringArray("target")]
script = ExtResource("18_i5i46")
target = NodePath("../DiscardPile")
res = ExtResource("19_4vnf4")

[node name="ConveyorBelt" type="Node2D" parent="ScreenBody/DeckSystem"]

[node name="Input" type="Node" parent="ScreenBody/DeckSystem/ConveyorBelt" node_paths=PackedStringArray("conveyor_cursor", "conveyor")]
script = ExtResource("6_0nco4")
params = ExtResource("7_lwbna")
conveyor_cursor = NodePath("../PlayCursor")
conveyor = NodePath("../Conveyor")

[node name="EnginePressure" type="Node" parent="ScreenBody/DeckSystem/ConveyorBelt" node_paths=PackedStringArray("engine_pressure", "conveyor_belt")]
script = ExtResource("8_om5io")
engine_pressure = NodePath("../../EnginePressure")
params = ExtResource("9_22oty")
conveyor_belt = NodePath("../Conveyor")

[node name="PlayCursor" type="RayCast2D" parent="ScreenBody/DeckSystem/ConveyorBelt" node_paths=PackedStringArray("grease_tank")]
position = Vector2(712, -244)
exclude_parent = false
target_position = Vector2(0, 1000)
collision_mask = 64
hit_from_inside = true
collide_with_areas = true
collide_with_bodies = false
script = ExtResource("10_da7bb")
params = ExtResource("11_b38iv")
grease_tank = NodePath("../../GreaseTank")

[node name="Conveyor" type="Area2D" parent="ScreenBody/DeckSystem/ConveyorBelt"]
position = Vector2(316, 44)
collision_layer = 16
collision_mask = 0
monitoring = false
script = ExtResource("12_cfnii")
params = ExtResource("13_4qym4")

[node name="CollisionShape2D" type="CollisionShape2D" parent="ScreenBody/DeckSystem/ConveyorBelt/Conveyor"]
position = Vector2(1395, 253)
shape = ExtResource("14_ab8fw")

[node name="JettisonTrigger" type="Area2D" parent="ScreenBody/DeckSystem/ConveyorBelt"]
position = Vector2(-173, 57)
scale = Vector2(-1.62359, 4.29162)
collision_layer = 64
collision_mask = 64
script = ExtResource("15_ssd4j")

[node name="CollisionShape2D" type="CollisionShape2D" parent="ScreenBody/DeckSystem/ConveyorBelt/JettisonTrigger"]
position = Vector2(324.743, 56.855)
scale = Vector2(0.999999, 1)
shape = SubResource("RectangleShape2D_tinjm")

[node name="DiscardTrigger" type="Area2D" parent="ScreenBody/DeckSystem/ConveyorBelt"]
position = Vector2(-1416, -624)
rotation = -0.518312
scale = Vector2(36.8114, 6.74649)
collision_layer = 64
collision_mask = 64
script = ExtResource("16_euwjv")

[node name="CollisionShape2D" type="CollisionShape2D" parent="ScreenBody/DeckSystem/ConveyorBelt/DiscardTrigger"]
position = Vector2(4.87621, -86.3042)
rotation = 3.14159
shape = SubResource("WorldBoundaryShape2D_171kb")

[node name="EnginePressure" type="Node" parent="ScreenBody/DeckSystem"]
script = ExtResource("17_ck7oh")
params = ExtResource("18_i714n")

[node name="GreaseTank" type="Node" parent="ScreenBody/DeckSystem"]
script = ExtResource("19_axreu")
params = ExtResource("20_u8qqm")

[node name="AudioManager" parent="." instance=ExtResource("34_ji0kl")]

[node name="AudioStreamPlayer" parent="." instance=ExtResource("35_y2nll")]

[connection signal="area_entered" from="ScreenBody/DeckSystem/ConveyorBelt/JettisonTrigger" to="ScreenBody/DeckSystem/ConveyorBelt/JettisonTrigger" method="_on_area_entered"]
[connection signal="area_entered" from="ScreenBody/DeckSystem/ConveyorBelt/DiscardTrigger" to="ScreenBody/DeckSystem/ConveyorBelt/DiscardTrigger" method="_on_area_entered"]
